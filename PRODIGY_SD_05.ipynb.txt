{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# import libraries\n",
    "# ================\n",
    "\n",
    "# for date and time opeations\n",
    "from datetime import datetime\n",
    "# for file and folder operations\n",
    "import os\n",
    "# for regular expression opeations\n",
    "import re\n",
    "# for listing files in a folder\n",
    "import glob\n",
    "# for getting web contents\n",
    "import requests \n",
    "# storing and analysing data\n",
    "import pandas as pd\n",
    "# for scraping web contents\n",
    "from bs4 import BeautifulSoup\n",
    "# regular expression\n",
    "import re\n",
    "# numerical analysis\n",
    "import numpy as np\n",
    "\n",
    "import warnings\n",
    "warnings.simplefilter(\"ignore\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# get data\n",
    "# ========\n",
    "\n",
    "# link at which web data recides\n",
    "link = 'https://www.worldometers.info/coronavirus/'\n",
    "# get web data\n",
    "req = requests.get(link)\n",
    "# parse web data\n",
    "soup = BeautifulSoup(req.content, \"html.parser\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "# find the table\n",
    "# ==============\n",
    "# our target table is the last table in the page\n",
    "\n",
    "# get the table head\n",
    "# table head may contain the column names, titles, subtitles\n",
    "thead = soup.find_all('thead')[-1]\n",
    "# print(thead)\n",
    "\n",
    "# get all the rows in table head\n",
    "# it usually have only one row, which has the column names\n",
    "head = thead.find_all('tr')\n",
    "# print(head)\n",
    "\n",
    "# get the table tbody\n",
    "# it contains the contents\n",
    "tbody = soup.find_all('tbody')[0]\n",
    "# print(tbody)\n",
    "\n",
    "# get all the rows in table body\n",
    "# each row is each state's entry\n",
    "body = tbody.find_all('tr')\n",
    "# print(body)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# get the table contents\n",
    "# ======================\n",
    "\n",
    "# container for header rows / column title\n",
    "head_rows = []\n",
    "# container for table body / contents\n",
    "body_rows = []\n",
    "\n",
    "# loop through the head and append each row to head\n",
    "for tr in head:\n",
    "    td = tr.find_all(['th', 'td'])\n",
    "    row = [i.text for i in td]\n",
    "    head_rows.append(row)\n",
    "# print(head_rows)\n",
    "\n",
    "# loop through the body and append each row to body\n",
    "for tr in body:\n",
    "    td = tr.find_all(['th', 'td'])\n",
    "    row = [i.text for i in td]\n",
    "    body_rows.append(row)\n",
    "# print(head_rows)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>#</th>\n",
       "      <th>Country,Other</th>\n",
       "      <th>TotalCases</th>\n",
       "      <th>NewCases</th>\n",
       "      <th>TotalDeaths</th>\n",
       "      <th>NewDeaths</th>\n",
       "      <th>TotalRecovered</th>\n",
       "      <th>NewRecovered</th>\n",
       "      <th>ActiveCases</th>\n",
       "      <th>Serious,Critical</th>\n",
       "      <th>...</th>\n",
       "      <th>TotalTests</th>\n",
       "      <th>Tests/\\n1M pop\\n</th>\n",
       "      <th>Population</th>\n",
       "      <th>Continent</th>\n",
       "      <th>1 Caseevery X ppl</th>\n",
       "      <th>1 Deathevery X ppl</th>\n",
       "      <th>1 Testevery X ppl</th>\n",
       "      <th>New Cases/1M pop</th>\n",
       "      <th>New Deaths/1M pop</th>\n",
       "      <th>Active Cases/1M pop</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td></td>\n",
       "      <td>\\nNorth America\\n</td>\n",
       "      <td>130,884,948</td>\n",
       "      <td></td>\n",
       "      <td>1,670,581</td>\n",
       "      <td></td>\n",
       "      <td>126,380,304</td>\n",
       "      <td>+1,452</td>\n",
       "      <td>2,834,063</td>\n",
       "      <td>7,382</td>\n",
       "      <td>...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>North America</td>\n",
       "      <td>\\n</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td></td>\n",
       "      <td>\\nAsia\\n</td>\n",
       "      <td>221,432,321</td>\n",
       "      <td>+122</td>\n",
       "      <td>1,552,902</td>\n",
       "      <td></td>\n",
       "      <td>205,590,734</td>\n",
       "      <td>+1,614</td>\n",
       "      <td>14,288,685</td>\n",
       "      <td>14,733</td>\n",
       "      <td>...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Asia</td>\n",
       "      <td>\\n</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td></td>\n",
       "      <td>\\nEurope\\n</td>\n",
       "      <td>253,058,066</td>\n",
       "      <td>+101</td>\n",
       "      <td>2,098,788</td>\n",
       "      <td>+1</td>\n",
       "      <td>248,377,509</td>\n",
       "      <td>+2,550</td>\n",
       "      <td>2,581,769</td>\n",
       "      <td>4,557</td>\n",
       "      <td>...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Europe</td>\n",
       "      <td>\\n</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td></td>\n",
       "      <td>\\nSouth America\\n</td>\n",
       "      <td>69,693,446</td>\n",
       "      <td></td>\n",
       "      <td>1,365,157</td>\n",
       "      <td></td>\n",
       "      <td>66,629,255</td>\n",
       "      <td></td>\n",
       "      <td>1,699,034</td>\n",
       "      <td>8,953</td>\n",
       "      <td>...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>South America</td>\n",
       "      <td>\\n</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td></td>\n",
       "      <td>\\nOceania\\n</td>\n",
       "      <td>14,791,673</td>\n",
       "      <td>+1,154</td>\n",
       "      <td>32,484</td>\n",
       "      <td></td>\n",
       "      <td>14,555,421</td>\n",
       "      <td></td>\n",
       "      <td>203,768</td>\n",
       "      <td>42</td>\n",
       "      <td>...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>Australia/Oceania</td>\n",
       "      <td>\\n</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "  #      Country,Other   TotalCases NewCases TotalDeaths NewDeaths  \\\n",
       "0    \\nNorth America\\n  130,884,948            1,670,581             \n",
       "1             \\nAsia\\n  221,432,321     +122   1,552,902             \n",
       "2           \\nEurope\\n  253,058,066     +101   2,098,788        +1   \n",
       "3    \\nSouth America\\n   69,693,446            1,365,157             \n",
       "4          \\nOceania\\n   14,791,673   +1,154      32,484             \n",
       "\n",
       "  TotalRecovered NewRecovered ActiveCases Serious,Critical  ... TotalTests  \\\n",
       "0    126,380,304       +1,452   2,834,063            7,382  ...              \n",
       "1    205,590,734       +1,614  14,288,685           14,733  ...              \n",
       "2    248,377,509       +2,550   2,581,769            4,557  ...              \n",
       "3     66,629,255                1,699,034            8,953  ...              \n",
       "4     14,555,421                  203,768               42  ...              \n",
       "\n",
       "  Tests/\\n1M pop\\n Population          Continent 1 Caseevery X ppl  \\\n",
       "0                                  North America                \\n   \n",
       "1                                           Asia                \\n   \n",
       "2                                         Europe                \\n   \n",
       "3                                  South America                \\n   \n",
       "4                              Australia/Oceania                \\n   \n",
       "\n",
       "  1 Deathevery X ppl 1 Testevery X ppl New Cases/1M pop New Deaths/1M pop  \\\n",
       "0                                                                           \n",
       "1                                                                           \n",
       "2                                                                           \n",
       "3                                                                           \n",
       "4                                                                           \n",
       "\n",
       "  Active Cases/1M pop  \n",
       "0                      \n",
       "1                      \n",
       "2                      \n",
       "3                      \n",
       "4                      \n",
       "\n",
       "[5 rows x 22 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# save contents in a dataframe\n",
    "# ============================\n",
    "    \n",
    "# skip last 3 rows, it contains unwanted info\n",
    "# head_rows contains column title\n",
    "df_bs = pd.DataFrame(body_rows[:len(body_rows)-6], \n",
    "                     columns=head_rows[0])         \n",
    "\n",
    "# Drop 'S. No.' column\n",
    "# df_bs.drop('S. No.', axis=1, inplace=True)\n",
    "\n",
    "df_bs.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>#</th>\n",
       "      <th>Country,Other</th>\n",
       "      <th>TotalCases</th>\n",
       "      <th>NewCases</th>\n",
       "      <th>TotalDeaths</th>\n",
       "      <th>NewDeaths</th>\n",
       "      <th>TotalRecovered</th>\n",
       "      <th>NewRecovered</th>\n",
       "      <th>ActiveCases</th>\n",
       "      <th>Serious,Critical</th>\n",
       "      <th>...</th>\n",
       "      <th>TotalTests</th>\n",
       "      <th>Tests/\\n1M pop\\n</th>\n",
       "      <th>Population</th>\n",
       "      <th>Continent</th>\n",
       "      <th>1 Caseevery X ppl</th>\n",
       "      <th>1 Deathevery X ppl</th>\n",
       "      <th>1 Testevery X ppl</th>\n",
       "      <th>New Cases/1M pop</th>\n",
       "      <th>New Deaths/1M pop</th>\n",
       "      <th>Active Cases/1M pop</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>228</th>\n",
       "      <td>221</td>\n",
       "      <td>Tuvalu</td>\n",
       "      <td>2,943</td>\n",
       "      <td></td>\n",
       "      <td>1</td>\n",
       "      <td></td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>12,066</td>\n",
       "      <td>Australia/Oceania</td>\n",
       "      <td>4</td>\n",
       "      <td>12,066</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>243,826</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>229</th>\n",
       "      <td>222</td>\n",
       "      <td>Saint Helena</td>\n",
       "      <td>2,166</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>2</td>\n",
       "      <td></td>\n",
       "      <td>2,164</td>\n",
       "      <td></td>\n",
       "      <td>...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>6,115</td>\n",
       "      <td>Africa</td>\n",
       "      <td>3</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>353,884</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>230</th>\n",
       "      <td>223</td>\n",
       "      <td>Falkland Islands</td>\n",
       "      <td>1,930</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>1,930</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td></td>\n",
       "      <td>...</td>\n",
       "      <td>8,632</td>\n",
       "      <td>2,439,107</td>\n",
       "      <td>3,539</td>\n",
       "      <td>South America</td>\n",
       "      <td>2</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>231</th>\n",
       "      <td>224</td>\n",
       "      <td>Montserrat</td>\n",
       "      <td>1,403</td>\n",
       "      <td></td>\n",
       "      <td>8</td>\n",
       "      <td></td>\n",
       "      <td>1,376</td>\n",
       "      <td></td>\n",
       "      <td>19</td>\n",
       "      <td></td>\n",
       "      <td>...</td>\n",
       "      <td>17,762</td>\n",
       "      <td>3,577,442</td>\n",
       "      <td>4,965</td>\n",
       "      <td>North America</td>\n",
       "      <td>4</td>\n",
       "      <td>621</td>\n",
       "      <td>0</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>3,827</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>232</th>\n",
       "      <td>225</td>\n",
       "      <td>Niue</td>\n",
       "      <td>1,053</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>1,052</td>\n",
       "      <td></td>\n",
       "      <td>1</td>\n",
       "      <td></td>\n",
       "      <td>...</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>1,622</td>\n",
       "      <td>Australia/Oceania</td>\n",
       "      <td>2</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>617</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows Ã— 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       #     Country,Other TotalCases NewCases  \\\n",
       "228  221            Tuvalu      2,943            \n",
       "229  222      Saint Helena      2,166            \n",
       "230  223  Falkland Islands      1,930            \n",
       "231  224        Montserrat      1,403            \n",
       "232  225              Niue      1,053            \n",
       "\n",
       "                           TotalDeaths NewDeaths TotalRecovered NewRecovered  \\\n",
       "228  1                                                      N/A          N/A   \n",
       "229                                                           2                \n",
       "230                                                       1,930                \n",
       "231  8                                                    1,376                \n",
       "232                                                       1,052                \n",
       "\n",
       "    ActiveCases Serious,Critical  ... TotalTests Tests/\\n1M pop\\n Population  \\\n",
       "228         N/A              N/A  ...                                12,066    \n",
       "229       2,164                   ...                                 6,115    \n",
       "230           0                   ...      8,632        2,439,107     3,539    \n",
       "231          19                   ...     17,762        3,577,442     4,965    \n",
       "232           1                   ...                                 1,622    \n",
       "\n",
       "             Continent 1 Caseevery X ppl 1 Deathevery X ppl 1 Testevery X ppl  \\\n",
       "228  Australia/Oceania                 4             12,066                     \n",
       "229             Africa                 3                                        \n",
       "230      South America                 2                                    0   \n",
       "231      North America                 4                621                 0   \n",
       "232  Australia/Oceania                 2                                        \n",
       "\n",
       "    New Cases/1M pop New Deaths/1M pop Active Cases/1M pop  \n",
       "228                                                243,826  \n",
       "229                                                353,884  \n",
       "230                                                         \n",
       "231                                                  3,827  \n",
       "232                                                    617  \n",
       "\n",
       "[5 rows x 22 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_bs.tail(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Country,Other</th>\n",
       "      <th>TotalCases</th>\n",
       "      <th>NewCases</th>\n",
       "      <th>TotalDeaths</th>\n",
       "      <th>NewDeaths</th>\n",
       "      <th>TotalRecovered</th>\n",
       "      <th>NewRecovered</th>\n",
       "      <th>ActiveCases</th>\n",
       "      <th>Serious,Critical</th>\n",
       "      <th>TotÂ Cases/1M pop</th>\n",
       "      <th>Deaths/1M pop</th>\n",
       "      <th>TotalTests</th>\n",
       "      <th>Tests/\\n1M pop\\n</th>\n",
       "      <th>Population</th>\n",
       "      <th>Continent</th>\n",
       "      <th>1 Caseevery X ppl</th>\n",
       "      <th>1 Deathevery X ppl</th>\n",
       "      <th>1 Testevery X ppl</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>USA</td>\n",
       "      <td>110,855,991</td>\n",
       "      <td></td>\n",
       "      <td>1,195,323</td>\n",
       "      <td></td>\n",
       "      <td>108,597,087</td>\n",
       "      <td></td>\n",
       "      <td>1,063,581</td>\n",
       "      <td>2,227</td>\n",
       "      <td>331,106</td>\n",
       "      <td>3,570</td>\n",
       "      <td>1,186,624,369</td>\n",
       "      <td>3,544,223</td>\n",
       "      <td>334,805,269</td>\n",
       "      <td>North America</td>\n",
       "      <td>3</td>\n",
       "      <td>280</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>India</td>\n",
       "      <td>45,026,261</td>\n",
       "      <td>+122</td>\n",
       "      <td>533,454</td>\n",
       "      <td></td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>32,010</td>\n",
       "      <td>379</td>\n",
       "      <td>935,879,495</td>\n",
       "      <td>665,334</td>\n",
       "      <td>1,406,631,776</td>\n",
       "      <td>Asia</td>\n",
       "      <td>31</td>\n",
       "      <td>2,637</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>France</td>\n",
       "      <td>40,138,560</td>\n",
       "      <td></td>\n",
       "      <td>167,642</td>\n",
       "      <td></td>\n",
       "      <td>39,970,918</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td></td>\n",
       "      <td>612,013</td>\n",
       "      <td>2,556</td>\n",
       "      <td>271,490,188</td>\n",
       "      <td>4,139,547</td>\n",
       "      <td>65,584,518</td>\n",
       "      <td>Europe</td>\n",
       "      <td>2</td>\n",
       "      <td>391</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Germany</td>\n",
       "      <td>38,810,419</td>\n",
       "      <td></td>\n",
       "      <td>181,956</td>\n",
       "      <td></td>\n",
       "      <td>38,240,600</td>\n",
       "      <td></td>\n",
       "      <td>387,863</td>\n",
       "      <td>N/A</td>\n",
       "      <td>462,670</td>\n",
       "      <td>2,169</td>\n",
       "      <td>122,332,384</td>\n",
       "      <td>1,458,359</td>\n",
       "      <td>83,883,596</td>\n",
       "      <td>Europe</td>\n",
       "      <td>2</td>\n",
       "      <td>461</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Brazil</td>\n",
       "      <td>38,338,153</td>\n",
       "      <td></td>\n",
       "      <td>709,407</td>\n",
       "      <td></td>\n",
       "      <td>36,249,161</td>\n",
       "      <td></td>\n",
       "      <td>1,379,585</td>\n",
       "      <td>N/A</td>\n",
       "      <td>178,024</td>\n",
       "      <td>3,294</td>\n",
       "      <td>63,776,166</td>\n",
       "      <td>296,146</td>\n",
       "      <td>215,353,593</td>\n",
       "      <td>South America</td>\n",
       "      <td>6</td>\n",
       "      <td>304</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Country,Other   TotalCases NewCases  \\\n",
       "0           USA  110,855,991            \n",
       "1         India   45,026,261     +122   \n",
       "2        France   40,138,560            \n",
       "3       Germany   38,810,419            \n",
       "4        Brazil   38,338,153            \n",
       "\n",
       "                                 TotalDeaths NewDeaths TotalRecovered  \\\n",
       "0  1,195,323                                              108,597,087   \n",
       "1    533,454                                                      N/A   \n",
       "2    167,642                                               39,970,918   \n",
       "3    181,956                                               38,240,600   \n",
       "4    709,407                                               36,249,161   \n",
       "\n",
       "  NewRecovered ActiveCases Serious,Critical TotÂ Cases/1M pop Deaths/1M pop  \\\n",
       "0                1,063,581            2,227          331,106         3,570   \n",
       "1          N/A         N/A              N/A           32,010           379   \n",
       "2                        0                           612,013         2,556   \n",
       "3                  387,863              N/A          462,670         2,169   \n",
       "4                1,379,585              N/A          178,024         3,294   \n",
       "\n",
       "      TotalTests Tests/\\n1M pop\\n      Population      Continent  \\\n",
       "0  1,186,624,369        3,544,223    334,805,269   North America   \n",
       "1    935,879,495          665,334  1,406,631,776            Asia   \n",
       "2    271,490,188        4,139,547     65,584,518          Europe   \n",
       "3    122,332,384        1,458,359     83,883,596          Europe   \n",
       "4     63,776,166          296,146    215,353,593   South America   \n",
       "\n",
       "  1 Caseevery X ppl 1 Deathevery X ppl 1 Testevery X ppl  \n",
       "0                 3                280                 0  \n",
       "1                31              2,637                 2  \n",
       "2                 2                391                 0  \n",
       "3                 2                461                 1  \n",
       "4                 6                304                 3  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# drop unwanted rows\n",
    "df_bs = df_bs.iloc[8:, :-3].reset_index(drop=True)\n",
    "\n",
    "# drop unwanted columns\n",
    "df_bs = df_bs.drop('#', axis=1)\n",
    "\n",
    "# first few rows\n",
    "df_bs.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Country,Other</th>\n",
       "      <th>Continent</th>\n",
       "      <th>Population</th>\n",
       "      <th>TotalCases</th>\n",
       "      <th>NewCases</th>\n",
       "      <th>TotalDeaths</th>\n",
       "      <th>NewDeaths</th>\n",
       "      <th>TotalRecovered</th>\n",
       "      <th>NewRecovered</th>\n",
       "      <th>ActiveCases</th>\n",
       "      <th>Serious,Critical</th>\n",
       "      <th>Tot Cases/1M pop</th>\n",
       "      <th>Deaths/1M pop</th>\n",
       "      <th>TotalTests</th>\n",
       "      <th>Tests/\\n1M pop\\n</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>USA</td>\n",
       "      <td>North America</td>\n",
       "      <td>334,805,269</td>\n",
       "      <td>110,855,991</td>\n",
       "      <td></td>\n",
       "      <td>1,195,323</td>\n",
       "      <td></td>\n",
       "      <td>108,597,087</td>\n",
       "      <td></td>\n",
       "      <td>1,063,581</td>\n",
       "      <td>2,227</td>\n",
       "      <td>331,106</td>\n",
       "      <td>3,570</td>\n",
       "      <td>1,186,624,369</td>\n",
       "      <td>3,544,223</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>India</td>\n",
       "      <td>Asia</td>\n",
       "      <td>1,406,631,776</td>\n",
       "      <td>45,026,261</td>\n",
       "      <td>+122</td>\n",
       "      <td>533,454</td>\n",
       "      <td></td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>N/A</td>\n",
       "      <td>32,010</td>\n",
       "      <td>379</td>\n",
       "      <td>935,879,495</td>\n",
       "      <td>665,334</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>France</td>\n",
       "      <td>Europe</td>\n",
       "      <td>65,584,518</td>\n",
       "      <td>40,138,560</td>\n",
       "      <td></td>\n",
       "      <td>167,642</td>\n",
       "      <td></td>\n",
       "      <td>39,970,918</td>\n",
       "      <td></td>\n",
       "      <td>0</td>\n",
       "      <td></td>\n",
       "      <td>612,013</td>\n",
       "      <td>2,556</td>\n",
       "      <td>271,490,188</td>\n",
       "      <td>4,139,547</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Germany</td>\n",
       "      <td>Europe</td>\n",
       "      <td>83,883,596</td>\n",
       "      <td>38,810,419</td>\n",
       "      <td></td>\n",
       "      <td>181,956</td>\n",
       "      <td></td>\n",
       "      <td>38,240,600</td>\n",
       "      <td></td>\n",
       "      <td>387,863</td>\n",
       "      <td>N/A</td>\n",
       "      <td>462,670</td>\n",
       "      <td>2,169</td>\n",
       "      <td>122,332,384</td>\n",
       "      <td>1,458,359</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Brazil</td>\n",
       "      <td>South America</td>\n",
       "      <td>215,353,593</td>\n",
       "      <td>38,338,153</td>\n",
       "      <td></td>\n",
       "      <td>709,407</td>\n",
       "      <td></td>\n",
       "      <td>36,249,161</td>\n",
       "      <td></td>\n",
       "      <td>1,379,585</td>\n",
       "      <td>N/A</td>\n",
       "      <td>178,024</td>\n",
       "      <td>3,294</td>\n",
       "      <td>63,776,166</td>\n",
       "      <td>296,146</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Country,Other      Continent      Population   TotalCases NewCases  \\\n",
       "0           USA  North America    334,805,269   110,855,991            \n",
       "1         India           Asia  1,406,631,776    45,026,261     +122   \n",
       "2        France         Europe     65,584,518    40,138,560            \n",
       "3       Germany         Europe     83,883,596    38,810,419            \n",
       "4        Brazil  South America    215,353,593    38,338,153            \n",
       "\n",
       "                                 TotalDeaths NewDeaths TotalRecovered  \\\n",
       "0  1,195,323                                              108,597,087   \n",
       "1    533,454                                                      N/A   \n",
       "2    167,642                                               39,970,918   \n",
       "3    181,956                                               38,240,600   \n",
       "4    709,407                                               36,249,161   \n",
       "\n",
       "  NewRecovered ActiveCases Serious,Critical Tot Cases/1M pop Deaths/1M pop  \\\n",
       "0                1,063,581            2,227          331,106         3,570   \n",
       "1          N/A         N/A              N/A           32,010           379   \n",
       "2                        0                           612,013         2,556   \n",
       "3                  387,863              N/A          462,670         2,169   \n",
       "4                1,379,585              N/A          178,024         3,294   \n",
       "\n",
       "      TotalTests Tests/\\n1M pop\\n  \n",
       "0  1,186,624,369        3,544,223  \n",
       "1    935,879,495          665,334  \n",
       "2    271,490,188        4,139,547  \n",
       "3    122,332,384        1,458,359  \n",
       "4     63,776,166          296,146  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# rename columns\n",
    "# df_bs.columns = ['Country/Region', 'TotalCases', 'NewCases', 'TotalDeaths', 'NewDeaths',\n",
    "#        'TotalRecovered', 'NewRecovered', 'ActiveCases', 'Serious,Critical',\n",
    "#        'Tot Cases/1M pop', 'Deaths/1M pop', 'TotalTests', 'Tests/1M pop',\n",
    "#        'Population', 'Continent']\n",
    "\n",
    "df_bs.columns = ['Country,Other', 'TotalCases', 'NewCases', 'TotalDeaths', 'NewDeaths',\n",
    "       'TotalRecovered', 'NewRecovered', 'ActiveCases', 'Serious,Critical',\n",
    "       'Tot Cases/1M pop', 'Deaths/1M pop', 'TotalTests', 'Tests/\\n1M pop\\n',\n",
    "       'Population', 'Continent', '1 Caseevery X ppl', '1 Deathevery X ppl',\n",
    "       '1 Testevery X ppl']\n",
    "\n",
    "# rearrange and subselect columns\n",
    "df_bs = df_bs[['Country,Other', 'Continent', 'Population', 'TotalCases', 'NewCases', 'TotalDeaths', 'NewDeaths',\n",
    "       'TotalRecovered', 'NewRecovered', 'ActiveCases', 'Serious,Critical',\n",
    "       'Tot Cases/1M pop', 'Deaths/1M pop', 'TotalTests', 'Tests/\\n1M pop\\n']]\n",
    "\n",
    "# first few rows\n",
    "df_bs.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "who_region = {}\n",
    "\n",
    "# African Region AFRO\n",
    "afro = \"Algeria, Angola, Cabo Verde, Congo, DRC, Eswatini, Sao Tome and Principe, Benin, South Sudan, Western Sahara, Congo (Brazzaville), Congo (Kinshasa), Cote d'Ivoire, Botswana, Burkina Faso, Burundi, Cameroon, Cape Verde, Central African Republic, Chad, Comoros, Ivory Coast, Democratic Republic of the Congo, Equatorial Guinea, Eritrea, Ethiopia, Gabon, Gambia, Ghana, Guinea, Guinea-Bissau, Kenya, Lesotho, Liberia, Madagascar, Malawi, Mali, Mauritania, Mauritius, Mozambique, Namibia, Niger, Nigeria, Republic of the Congo, Rwanda, SÃ£o TomÃ© and PrÃ­ncipe, Senegal, Seychelles, Sierra Leone, Somalia, South Africa, Swaziland, Togo, Uganda, Tanzania, Zambia, Zimbabwe\"\n",
    "afro = [i.strip() for i in afro.split(',')]\n",
    "for i in afro:\n",
    "    who_region[i] = 'Africa'\n",
    "    \n",
    "# Region of the Americas PAHO\n",
    "paho = 'Antigua and Barbuda, Argentina, Bahamas, Barbados, Belize, Bermuda, Bolivia, Brazil, Canada, Chile, Colombia, Costa Rica, Cuba, Dominica, Dominican Republic, Ecuador, El Salvador, Grenada, Guatemala, Guyana, Haiti, Honduras, Jamaica, Mexico, Nicaragua, Panama, Paraguay, Peru, Saint Kitts and Nevis, Saint Lucia, Saint Vincent and the Grenadines, Suriname, Trinidad and Tobago, United States, US, USA, Uruguay, Venezuela'\n",
    "paho = [i.strip() for i in paho.split(',')]\n",
    "for i in paho:\n",
    "    who_region[i] = 'Americas'\n",
    "\n",
    "# South-East Asia Region SEARO\n",
    "searo = 'Bangladesh, Bhutan, North Korea, India, Indonesia, Maldives, Myanmar, Burma, Nepal, Sri Lanka, Thailand, Timor-Leste'\n",
    "searo = [i.strip() for i in searo.split(',')]\n",
    "for i in searo:\n",
    "    who_region[i] = 'South-East Asia'\n",
    "\n",
    "# European Region EURO\n",
    "euro = 'Albania, Andorra, Greenland, Kosovo, Holy See, Vatican City, Liechtenstein, Armenia, Czechia, Austria, Azerbaijan, Belarus, Belgium, Bosnia and Herzegovina, Bulgaria, Croatia, Cyprus, Czech Republic, Denmark, Estonia, Finland, France, Georgia, Germany, Greece, Hungary, Iceland, Ireland, Israel, Italy, Kazakhstan, Kyrgyzstan, Latvia, Lithuania, Luxembourg, Malta, Monaco, Montenegro, Netherlands, North Macedonia, Norway, Poland, Portugal, Moldova, Romania, Russia, San Marino, Serbia, Slovakia, Slovenia, Spain, Sweden, Switzerland, Tajikistan, Turkey, Turkmenistan, Ukraine, United Kingdom, UK, Uzbekistan'\n",
    "euro = [i.strip() for i in euro.split(',')]\n",
    "for i in euro:\n",
    "    who_region[i] = 'Europe'\n",
    "\n",
    "# Eastern Mediterranean Region EMRO\n",
    "emro = 'Afghanistan, Bahrain, Djibouti, Egypt, Iran, Iraq, Jordan, Kuwait, Lebanon, Libya, Morocco, Oman, Pakistan, Palestine, West Bank and Gaza, Qatar, Saudi Arabia, Somalia, Sudan, Syria, Tunisia, United Arab Emirates, UAE, Yemen'\n",
    "emro = [i.strip() for i in emro.split(',')]\n",
    "for i in emro:\n",
    "    who_region[i] = 'Eastern Mediterranean'\n",
    "\n",
    "# Western Pacific Region WPRO\n",
    "wpro = 'Australia, Brunei, Cambodia, China, Cook Islands, Fiji, Japan, Hong Kong, Kiribati, Laos, Malaysia, Marshall Islands, Micronesia, Mongolia, Nauru, New Zealand, Niue, Palau, Papua New Guinea, Philippines, South Korea, S. Korea, Samoa, Singapore, Solomon Islands, Taiwan, Taiwan*, Tonga, Tuvalu, Vanuatu, Vietnam'\n",
    "wpro = [i.strip() for i in wpro.split(',')]\n",
    "for i in wpro:\n",
    "    who_region[i] = 'Western Pacific'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['DPRK', 'RÃ©union', 'Brunei ', 'Martinique', 'Guadeloupe',\n",
       "       'Channel Islands', 'French Guiana', 'New Caledonia',\n",
       "       'French Polynesia', 'CuraÃ§ao', 'Aruba', 'Mayotte', 'Isle of Man',\n",
       "       'Faeroe Islands', 'Cayman Islands', 'Macao', 'Gibraltar', 'CAR',\n",
       "       'Saint Martin', 'Caribbean Netherlands', 'Sint Maarten',\n",
       "       'St. Vincent Grenadines', 'British Virgin Islands',\n",
       "       'Turks and Caicos', 'St. Barth', 'Anguilla', 'Wallis and Futuna',\n",
       "       'Saint Pierre Miquelon', 'Saint Helena', 'Falkland Islands',\n",
       "       'Montserrat'], dtype=object)"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# addding 'WHO Region' column\n",
    "df_bs['WHO Region'] = df_bs['Country,Other'].map(who_region)\n",
    "\n",
    "# countries with missing \"WHO Region\"\n",
    "df_bs[df_bs['WHO Region'].isna()]['Country,Other'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "# fix data\n",
    "for col in df_bs.columns[2:]:\n",
    "    # replace comma with empty string\n",
    "    df_bs[col] = df_bs[col].str.replace('[,+ ]', '', regex=True)\n",
    "    # replace 'N/A' with empty string\n",
    "    df_bs[col] = df_bs[col].str.replace('N/A', '', regex=False)\n",
    "\n",
    "# replace empty strings with np.nan\n",
    "df_bs = df_bs.replace('', np.nan)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Country,Other</th>\n",
       "      <th>Continent</th>\n",
       "      <th>Population</th>\n",
       "      <th>TotalCases</th>\n",
       "      <th>NewCases</th>\n",
       "      <th>TotalDeaths</th>\n",
       "      <th>NewDeaths</th>\n",
       "      <th>TotalRecovered</th>\n",
       "      <th>NewRecovered</th>\n",
       "      <th>ActiveCases</th>\n",
       "      <th>Serious,Critical</th>\n",
       "      <th>Tot Cases/1M pop</th>\n",
       "      <th>Deaths/1M pop</th>\n",
       "      <th>TotalTests</th>\n",
       "      <th>Tests/\\n1M pop\\n</th>\n",
       "      <th>WHO Region</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>USA</td>\n",
       "      <td>North America</td>\n",
       "      <td>334805269</td>\n",
       "      <td>110855991</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1195323</td>\n",
       "      <td>NaN</td>\n",
       "      <td>108597087</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1063581</td>\n",
       "      <td>2227</td>\n",
       "      <td>331106</td>\n",
       "      <td>3570</td>\n",
       "      <td>1186624369</td>\n",
       "      <td>3544223</td>\n",
       "      <td>Americas</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>India</td>\n",
       "      <td>Asia</td>\n",
       "      <td>1406631776</td>\n",
       "      <td>45026261</td>\n",
       "      <td>122</td>\n",
       "      <td>533454</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>32010</td>\n",
       "      <td>379</td>\n",
       "      <td>935879495</td>\n",
       "      <td>665334</td>\n",
       "      <td>South-EastAsia</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>France</td>\n",
       "      <td>Europe</td>\n",
       "      <td>65584518</td>\n",
       "      <td>40138560</td>\n",
       "      <td>NaN</td>\n",
       "      <td>167642</td>\n",
       "      <td>NaN</td>\n",
       "      <td>39970918</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>612013</td>\n",
       "      <td>2556</td>\n",
       "      <td>271490188</td>\n",
       "      <td>4139547</td>\n",
       "      <td>Europe</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Germany</td>\n",
       "      <td>Europe</td>\n",
       "      <td>83883596</td>\n",
       "      <td>38810419</td>\n",
       "      <td>NaN</td>\n",
       "      <td>181956</td>\n",
       "      <td>NaN</td>\n",
       "      <td>38240600</td>\n",
       "      <td>NaN</td>\n",
       "      <td>387863</td>\n",
       "      <td>NaN</td>\n",
       "      <td>462670</td>\n",
       "      <td>2169</td>\n",
       "      <td>122332384</td>\n",
       "      <td>1458359</td>\n",
       "      <td>Europe</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Brazil</td>\n",
       "      <td>South America</td>\n",
       "      <td>215353593</td>\n",
       "      <td>38338153</td>\n",
       "      <td>NaN</td>\n",
       "      <td>709407</td>\n",
       "      <td>NaN</td>\n",
       "      <td>36249161</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1379585</td>\n",
       "      <td>NaN</td>\n",
       "      <td>178024</td>\n",
       "      <td>3294</td>\n",
       "      <td>63776166</td>\n",
       "      <td>296146</td>\n",
       "      <td>Americas</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Country,Other      Continent  Population TotalCases NewCases TotalDeaths  \\\n",
       "0           USA  North America   334805269  110855991      NaN     1195323   \n",
       "1         India           Asia  1406631776   45026261      122      533454   \n",
       "2        France         Europe    65584518   40138560      NaN      167642   \n",
       "3       Germany         Europe    83883596   38810419      NaN      181956   \n",
       "4        Brazil  South America   215353593   38338153      NaN      709407   \n",
       "\n",
       "  NewDeaths TotalRecovered NewRecovered ActiveCases Serious,Critical  \\\n",
       "0       NaN      108597087          NaN     1063581             2227   \n",
       "1       NaN            NaN          NaN         NaN              NaN   \n",
       "2       NaN       39970918          NaN           0              NaN   \n",
       "3       NaN       38240600          NaN      387863              NaN   \n",
       "4       NaN       36249161          NaN     1379585              NaN   \n",
       "\n",
       "  Tot Cases/1M pop Deaths/1M pop  TotalTests Tests/\\n1M pop\\n      WHO Region  \n",
       "0           331106          3570  1186624369          3544223        Americas  \n",
       "1            32010           379   935879495           665334  South-EastAsia  \n",
       "2           612013          2556   271490188          4139547          Europe  \n",
       "3           462670          2169   122332384          1458359          Europe  \n",
       "4           178024          3294    63776166           296146        Americas  "
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# first few rows\n",
    "df_bs.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Country,Other</th>\n",
       "      <th>Continent</th>\n",
       "      <th>Population</th>\n",
       "      <th>TotalCases</th>\n",
       "      <th>NewCases</th>\n",
       "      <th>TotalDeaths</th>\n",
       "      <th>NewDeaths</th>\n",
       "      <th>TotalRecovered</th>\n",
       "      <th>NewRecovered</th>\n",
       "      <th>ActiveCases</th>\n",
       "      <th>Serious,Critical</th>\n",
       "      <th>Tot Cases/1M pop</th>\n",
       "      <th>Deaths/1M pop</th>\n",
       "      <th>TotalTests</th>\n",
       "      <th>Tests/\\n1M pop\\n</th>\n",
       "      <th>WHO Region</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>220</th>\n",
       "      <td>Tuvalu</td>\n",
       "      <td>Australia/Oceania</td>\n",
       "      <td>12066</td>\n",
       "      <td>2943</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>243909</td>\n",
       "      <td>83</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>WesternPacific</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>221</th>\n",
       "      <td>Saint Helena</td>\n",
       "      <td>Africa</td>\n",
       "      <td>6115</td>\n",
       "      <td>2166</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2164</td>\n",
       "      <td>NaN</td>\n",
       "      <td>354211</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>222</th>\n",
       "      <td>Falkland Islands</td>\n",
       "      <td>South America</td>\n",
       "      <td>3539</td>\n",
       "      <td>1930</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1930</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>545352</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8632</td>\n",
       "      <td>2439107</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>223</th>\n",
       "      <td>Montserrat</td>\n",
       "      <td>North America</td>\n",
       "      <td>4965</td>\n",
       "      <td>1403</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1376</td>\n",
       "      <td>NaN</td>\n",
       "      <td>19</td>\n",
       "      <td>NaN</td>\n",
       "      <td>282578</td>\n",
       "      <td>1611</td>\n",
       "      <td>17762</td>\n",
       "      <td>3577442</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>224</th>\n",
       "      <td>Niue</td>\n",
       "      <td>Australia/Oceania</td>\n",
       "      <td>1622</td>\n",
       "      <td>1053</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1052</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>649199</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>WesternPacific</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        Country,Other          Continent Population TotalCases NewCases  \\\n",
       "220            Tuvalu  Australia/Oceania      12066       2943      NaN   \n",
       "221      Saint Helena             Africa       6115       2166      NaN   \n",
       "222  Falkland Islands      South America       3539       1930      NaN   \n",
       "223        Montserrat      North America       4965       1403      NaN   \n",
       "224              Niue  Australia/Oceania       1622       1053      NaN   \n",
       "\n",
       "    TotalDeaths NewDeaths TotalRecovered NewRecovered ActiveCases  \\\n",
       "220           1       NaN            NaN          NaN         NaN   \n",
       "221         NaN       NaN              2          NaN        2164   \n",
       "222         NaN       NaN           1930          NaN           0   \n",
       "223           8       NaN           1376          NaN          19   \n",
       "224         NaN       NaN           1052          NaN           1   \n",
       "\n",
       "    Serious,Critical Tot Cases/1M pop Deaths/1M pop TotalTests  \\\n",
       "220              NaN           243909            83        NaN   \n",
       "221              NaN           354211           NaN        NaN   \n",
       "222              NaN           545352           NaN       8632   \n",
       "223              NaN           282578          1611      17762   \n",
       "224              NaN           649199           NaN        NaN   \n",
       "\n",
       "    Tests/\\n1M pop\\n      WHO Region  \n",
       "220              NaN  WesternPacific  \n",
       "221              NaN             NaN  \n",
       "222          2439107             NaN  \n",
       "223          3577442             NaN  \n",
       "224              NaN  WesternPacific  "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# first few rows\n",
    "df_bs.tail()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "# save as .csv file\n",
    "df_bs.to_csv('worldometer_data.csv', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
